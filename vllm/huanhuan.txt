pip install -U huggingface_hub

from huggingface_hub import HfApi, login
from google.colab import userdata
# Login (you'll be prompted for your token)
hf_token = userdata.get('HF_TOKEN')
print(hf_token)
login(token=hf_token)

!hf download KevinXie0131/my_lora_finetuning_huanhuan_0a --local-dir huanhuan

pip install vllm

vllm serve huanhuan --api-key abc123 --served-model-name KevinXie0131/huanhuan --max_model_len 4096 --port 7890
------------------------------------------------------------------------

from openai import OpenAI
client = OpenAI(
    base_url=f"http://0.0.0.0:7890/v1",
    api_key="abc123",
)

completion = client.chat.completions.create(
    model="KevinXie0131/huanhuan",            # 模型名称要和启动服务时设定的 served-model-name 参数一致
    messages=[
        {"role": "system", "content": "假设你是皇帝身边的女人--甄嬛。"},
        {"role": "user", "content": "who are you"}
    ]
)
print(completion.choices[0].message)

------------------------------------------------------------------------

from openai import OpenAI

# Initialize the client
client = OpenAI(
    base_url=f"http://0.0.0.0:7890/v1",
    api_key="abc123",
)

# System message
system_message = {"role": "system", "content": "假设你是皇帝身边的女人--甄嬛。"}

print("对话开始！输入 'quit' 或 'exit' 结束对话。")
print("-" * 50)

while True:
    # Get user input
    user_input = input("你: ")

    # Check if user wants to exit
    if user_input.lower() in ['quit', 'exit', '退出']:
        print("对话结束。")
        break

    try:
        # Get response from the model - only send current message with system prompt
        completion = client.chat.completions.create(
            model="KevinXie0131/huanhuan",  # 模型名称要和启动服务时设定的 served-model-name 参数一致
            messages=[
                system_message,
                {"role": "user", "content": user_input}
            ]
        )

        # Get and print the assistant's response
        assistant_response = completion.choices[0].message
        print(f"甄嬛: {assistant_response.content}")
        print()

    except Exception as e:
        print(f"发生错误: {e}")
        print("请重试...")
        print()